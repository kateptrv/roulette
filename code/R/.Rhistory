if(!suppressWarnings(require(pacman))){install.packages("pacman");library("pacman")}
p_load(tidyverse, tidyr, dplyr, ggplot2, stats, sjPlot, readr, ggpubr, patchwork, lubridate, ggthemr, ggdist, ggpubr, showtext, usethis, data.table, png, grid, purrr, ggimage, osfr, jsonlite)
osf_auth("66AefRY1PgjjUltWF9ztQrNPkKj1eyCr9v9YZDkWk5sQb9TCsbZds2Yl32kNXqj6TAm5SI")
roulette_osf <- osf_retrieve_node("https://osf.io/u36hw/")
data_files <- osf_ls_files(roulette_osf)
data_files
#download all files in the osf project into ../../data
osf_retrieve_node("https://osf.io/u36hw/") |>
osf_ls_files() |>
osf_download(path = "data")
#download all files in the osf project into ../../data
osf_retrieve_node("https://osf.io/u36hw/") |>
osf_ls_files() |>
osf_download(path = "../../data")
# delete files containing "sess-NA" in their filename
file.remove(list.files(path = "data/", pattern = "sess-NA", full.names = TRUE))
# concatenate files with sess != NA
data_raw <- list.files(path = "data/", pattern = "roulette_pid", full.names = TRUE) |>
lapply(read_csv) |>
bind_rows()
write_csv(data_raw, "data/data_raw.csv")
data_raw
#download all files in the osf project into ../../data
osf_retrieve_node("https://osf.io/u36hw/") |>
osf_ls_files() |>
osf_download(path = "data")
#download all files in the osf project into ../../data
osf_retrieve_node("https://osf.io/u36hw/") |>
osf_ls_files() |>
osf_download(path = "data/")
data_raw <- read_csv("../../data/data_raw.csv")
View(data_raw)
View(data_raw)
data_clean <- data_raw |>
filter(trial_type != "instructions" & trial_type != "survey-multi-choice")
data_clean <- data_raw |>
filter(trial_type != "instructions" & trial_type != "survey-multi-choice") |>
select(prolific_pid, balance, choice, outcome, response, banner, win_status, hot_set_size, hot_numbers, outcome_rel_to_hot, trial_type, rt)
View(data_clean)
data_clean <- data_raw |>
filter(trial_type != "instructions" & trial_type != "survey-multi-choice") |>
select(prolific_pid, balance, choice, outcome, response, banner, win_status, hot_set_size, hot_numbers, outcome_rel_to_hot, trial_type, rt) |>
group_by(prolific_pid) |>
mutate(response = lead(response, 2)) |>
ungroup()
View(data_clean)
data_clean <- data_raw |>
filter(trial_type != "instructions" & trial_type != "survey-multi-choice") |>
select(prolific_pid, balance, choice, outcome, response, banner, win_status, hot_set_size, hot_numbers, outcome_rel_to_hot, trial_type, rt) |>
group_by(prolific_pid) |>
mutate(response = lead(response, 2)) |>
ungroup() |>
filter(!(is.na(balance) & is.na(hot_numbers)))
View(data_clean)
data_clean <- data_raw |>
filter(trial_type != "instructions" & trial_type != "survey-multi-choice") |>
select(prolific_pid, balance, choice, outcome, response, banner, win_status, hot_set_size, hot_numbers, outcome_rel_to_hot, trial_type, rt) |>
group_by(prolific_pid) |>
mutate(response = lead(response, 2)) |>
ungroup() |>
filter(!(is.na(balance) & is.na(hot_numbers))) |>
filter(!(is.na(rt)))
View(data_clean)
data_clean <- data_raw |>
filter(trial_type != "instructions" & trial_type != "survey-multi-choice") |>
select(prolific_pid, balance, choice, outcome, response, banner, win_status, hot_set_size, hot_numbers, outcome_rel_to_hot, trial_type, rt) |>
group_by(prolific_pid) |>
mutate(response = lead(response, 2)) |>
ungroup() |>
filter(!(is.na(balance) & is.na(hot_numbers)))
View(data_clean)
data_clean <- data_raw |>
filter(trial_type != "instructions" & trial_type != "survey-multi-choice") |>
select(prolific_pid, balance, choice, outcome, response, banner, win_status, hot_set_size, hot_numbers, outcome_rel_to_hot, trial_type, rt) |>
group_by(prolific_pid) |>
mutate(response = lead(response, 2)) |>
ungroup() |>
filter(!(is.na(balance) & is.na(hot_numbers))) |>
filter(!(is.na(balance)))
View(data_clean)
data_clean <- data_raw |>
filter(trial_type != "instructions" & trial_type != "survey-multi-choice") |>
select(prolific_pid, balance, choice, outcome, response, banner, win_status, hot_set_size, hot_numbers, outcome_rel_to_hot, trial_type, rt) |>
group_by(prolific_pid) |>
mutate(response = lead(response, 2)) |>
ungroup() |>
filter(!(is.na(balance) & is.na(hot_numbers))) |>
filter(!(is.na(balance))) |>
mutate(trial = row_number()) |>
select(-c(trial_type, rt, hot_numbers))
data_clean <- data_raw |>
filter(trial_type != "instructions" & trial_type != "survey-multi-choice") |>
select(prolific_pid, balance, choice, outcome, response, banner, win_status, hot_set_size, hot_numbers, outcome_rel_to_hot, trial_type, rt) |>
group_by(prolific_pid) |>
mutate(response = lead(response, 2)) |>
ungroup() |>
filter(!(is.na(balance) & is.na(hot_numbers))) |>
filter(!(is.na(balance))) |>
group_by(prolific_pid) |>
mutate(trial = row_number()) |>
ungroup() |>
select(-c(trial_type, rt, hot_numbers))
View(data_clean)
24*10
192+24
216+24
# output participant bonuses (balance at trial_index = 24). all should be 1.5
bonus_payment <- data_clean |>
filter(trial == 24) |>
select(prolific_pid, balance)
cat(paste(bonus_payments$prolific_pid, bonus_payments$balance, sep = ","), sep = "\n")
# output participant bonuses (balance at trial_index = 24). all should be 1.5
bonus_payment <- data_clean |>
filter(trial == 24) |>
select(prolific_pid, balance)
cat(paste(bonus_payments$prolific_pid, bonus_payment$balance, sep = ","), sep = "\n")
# output participant bonuses (balance at trial_index = 24). all should be 1.5
bonus_payment <- data_clean |>
filter(trial == 24) |>
select(prolific_pid, balance)
cat(paste(bonus_payment$prolific_pid, bonus_payment$balance, sep = ","), sep = "\n")
# output participant bonuses (balance at trial_index = 24). all should be 1.5
bonus_payment <- data_clean |>
filter(trial == 24) |>
select(prolific_pid, balance)
cat(paste(bonus_payment$prolific_pid, bonus_payment$balance, sep = ","), sep = "\n")
1.75+1.50
3.25*1.33
4.3225*90
data_clean <- data_raw |>
filter(trial_type != "instructions" & trial_type != "survey-multi-choice") |>
select(prolific_pid, balance, choice, outcome, response, banner, win_status, hot_set_size, hot_numbers, outcome_rel_to_hot, trial_type, rt) |>
group_by(prolific_pid) |>
mutate(response = lead(response, 2)) |>
ungroup() |>
filter(!(is.na(balance) & is.na(hot_numbers))) |>
filter(!(is.na(balance))) |>
group_by(prolific_pid) |>
mutate(trial = row_number()) |>
ungroup() |>
select(-c(trial_type, rt, hot_numbers)) |>
mutate(
response_parsed = map(response, ~ fromJSON(.x))
) %>%
mutate(
regret_chosen = map_dbl(response_parsed, ~ .x$regret_chosen %||% NA_real_),
regret_not_winner = map_dbl(response_parsed, ~ .x$regret_not_winner %||% NA_real_),
regret_not_hot_probe = map_dbl(response_parsed, ~ .x$regret_not_hot_probe %||% NA_real_)
) %>%
select(-response_parsed)
View(data_clean)
data_clean <- data_raw |>
filter(trial_type != "instructions" & trial_type != "survey-multi-choice") |>
select(prolific_pid, balance, choice, outcome, response, banner, win_status, hot_set_size, hot_numbers, outcome_rel_to_hot, trial_type, rt) |>
group_by(prolific_pid) |>
mutate(response = lead(response, 2)) |>
ungroup() |>
filter(!(is.na(balance) & is.na(hot_numbers))) |>
filter(!(is.na(balance))) |>
group_by(prolific_pid) |>
mutate(trial = row_number()) |>
ungroup() |>
select(-c(trial_type, rt, hot_numbers)) |>
mutate(
response_parsed = map(response, ~ fromJSON(.x))
) %>%
mutate(
regret_chosen = map_dbl(response_parsed, ~ .x$regret_chosen %||% NA_real_),
regret_nc_winner = map_dbl(response_parsed, ~ .x$regret_not_winner %||% NA_real_),
regret_nc_hot_loser = map_dbl(response_parsed, ~ .x$regret_not_hot_probe %||% NA_real_)
) %>%
select(-c(response, response_parsed))
View(data_clean)
View(data_clean)
data_clean <- data_raw |>
filter(trial_type != "instructions" & trial_type != "survey-multi-choice") |>
select(prolific_pid, balance, choice, outcome, response, banner, win_status, hot_set_size, hot_numbers, outcome_rel_to_hot, trial_type, rt) |>
group_by(prolific_pid) |>
mutate(response = lead(response, 2)) |>
ungroup() |>
filter(!(is.na(balance) & is.na(hot_numbers))) |>
filter(!(is.na(balance))) |>
group_by(prolific_pid) |>
mutate(trial = row_number()) |>
ungroup() |>
select(-c(trial_type, rt, hot_numbers)) |>
mutate(
response_parsed = map(response, ~ fromJSON(.x))
) %>%
mutate(
regret_chosen = map_dbl(response_parsed, ~ .x$regret_chosen %||% NA_real_),
regret_notchosen_winner = map_dbl(response_parsed, ~ .x$regret_not_winner %||% NA_real_),
regret_notchosen_hot_loser = map_dbl(response_parsed, ~ .x$regret_not_hot_probe %||% NA_real_)
) %>%
select(-c(response, response_parsed)) |>
rename(winner_number = outcome,
chosen_number = choice,
banner_yn = banner) |>
relocate(trial, .after = prolific_pid)
View(data_clean)
data_clean <- data_raw |>
filter(trial_type != "instructions" & trial_type != "survey-multi-choice") |>
select(prolific_pid, balance, choice, outcome, response, banner, win_status, hot_set_size, hot_numbers, outcome_rel_to_hot, trial_type, rt) |>
group_by(prolific_pid) |>
mutate(response = lead(response, 2)) |>
ungroup() |>
filter(!(is.na(balance) & is.na(hot_numbers))) |>
filter(!(is.na(balance))) |>
group_by(prolific_pid) |>
mutate(trial = row_number()) |>
ungroup() |>
select(-c(trial_type, rt, hot_numbers)) |>
mutate(
response_parsed = map(response, ~ fromJSON(.x))
) %>%
mutate(
regret_chosen = map_dbl(response_parsed, ~ .x$regret_chosen %||% NA_real_),
regret_notchosen_winner = map_dbl(response_parsed, ~ .x$regret_not_winner %||% NA_real_),
regret_notchosen_hot_loser = map_dbl(response_parsed, ~ .x$regret_not_hot_probe %||% NA_real_)
) %>%
select(-c(response, response_parsed)) |>
rename(winner_number = outcome,
chosen_number = choice,
banner_yn = banner) |>
relocate(trial, .after = prolific_pid)
write_csv(data_clean, "../../data/data_clean.csv")
# session info
sessionInfo() |>
capture.output("processing_session_info.txt")
if(!suppressWarnings(require(pacman))){install.packages("pacman");library("pacman")}
p_load(tidyverse, tidyr, dplyr, ggplot2, stats, sjPlot, readr, ggpubr, patchwork, lubridate, ggthemr, ggdist, ggpubr, showtext, usethis, data.table, png, grid, purrr, ggimage, osfr, jsonlite)
osf_auth("66AefRY1PgjjUltWF9ztQrNPkKj1eyCr9v9YZDkWk5sQb9TCsbZds2Yl32kNXqj6TAm5SI")
roulette_osf <- osf_retrieve_node("https://osf.io/u36hw/")
data_files <- osf_ls_files(roulette_osf)
data_files
#download all files in the osf project into ../../data
osf_retrieve_node("https://osf.io/u36hw/") |>
osf_ls_files() |>
osf_download(path = "data/")
#download all files in the osf project into ../../data
osf_retrieve_node("https://osf.io/u36hw/") |>
osf_ls_files() |>
osf_download(path = "data")
data_raw <- read_csv("../../data/data_raw.csv")
usethis::edit_r_environ()
